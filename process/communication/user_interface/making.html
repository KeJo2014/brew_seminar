<!doctype html>

<html lang="de">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Zubereitung</title>
    <meta name="description" content="Zubereitung">
    <meta name="author" content="J">

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="css/styles.css?v=1.0">
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"></script>
</head>

<body id="making-html">
    <h1>Zubereitung</h1>
    <div class="row">
    <div class="column">
    <div class="glass-div">
        <table class="list">
            <tr>
                <th>Phase</th>
                <td>Maischen</td>
            </tr>
            <tr>
                <th>Temperatur</th>
                <td>78°C</td>
            </tr>
            <tr>
                <th>Rührwerk</th>
                <td>AN</td>
            </tr>
        </table>
    </div>
    <div class="glass-div">
        <!-- <button id="but-start" onclick="start()">Start</button><br> -->
        <!-- <button id="but-reset" onclick="reset()">Reset</button><br> -->
        <button id="but-undo" onclick="undoDone()">undo</button><br>
        <button id="but-next" onclick="next()">Next</button><br>
        <button id="but-stop" onclick="stop()">STOP</button>
        <button id="but-protokoll" onclick="protocol()">Protokoll</button>
    </div>
</div>
<div class="column">
    <div class="glass-div">
        <h2 class="step">momentaner Schritt</h2>
        <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
        <h2 class="step">nächster Schritt</h2>
        <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>

    </div>
    
</div>
</div>
</body>
<script>
    // Create WebSocket connection.
    const socket = new WebSocket('ws://localhost:80');

    // Connection opened
    socket.addEventListener('open', function (event) {
        console.log('Connected to the WS Server!')
    });

    // Connection closed
    socket.addEventListener('close', function (event) {
        console.log('Disconnected from the WS Server!')
    });

    // Listen for messages
    socket.addEventListener('message', function (event) {
        x = JSON.parse(event.data);
        switch (x['command']) {
            case 'select_recipe':
                console.log("test.fbp seems to be selected");
                socket.send('{"command":"select_recipe","response":"test.fbp"}');
                break;
            case 'reponse':
                console.log("Server response: " + x);
                break;
            case 'error':
                console.log("Server error: " + x['error_msg']);
                break;
            case 'switch_to_maischen':
                console.log("Switch to Maische");
                socket.send('{"command":"switch_to_maischen"}');
                break;
            case 'm_update':
                console.log(x);
                break;
            case 'transmit_information':
                console.log(x);
                break;
            case 'finish_maisch':
                console.log('finish_maisch! | sending next step');
                socket.send('{"command":"next"}');
                break;
            default:
                console.log("Unkown command: " + event.data);

                break;
        }
    });
    // Send a msg to the websocket
    const start = () => {
        socket.send('{"command":"start"}');
    }
    const next = () => {
        socket.send('{"command":"next"}');
    }
    const reset = () => {
        socket.send('{"command":"reset"}');
    }
    const undoDone = () => {
        socket.send('{"command":"undo_last"}');
    }
    const stop = () => {
        socket.send('{"command":"stop"}');
    }
    const protocol = () => {
        socket.send('{"command":"safe_protocol","protocol":"test"}');
    }
</script>


</html>